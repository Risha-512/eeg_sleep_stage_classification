# *Классификация стадий сна на основе данных ЭЭГ*

## Источники
 - [Модель сверточной нейронной сети](https://towardsdatascience.com/sleep-stage-classification-from-single-channel-eeg-using-convolutional-neural-networks-5c710d92d38e)
 - [Данные ЭЭГ](https://www.physionet.org/content/sleep-edfx/1.0.0/#ref1)

Английская версия расположена в ветке "master"

## Задача
Классификацировать данные ЭЭГ по стадиям сна, используя модель сверточной нейронной сети

***

## Обработка данных
Чтобы преобразовать файлы исходных данных формата *EDF* в формат *npz*, необходимо запустить скрипт **edf_to_npz_parsing/main.py**

### Параметры:

параметр           | описание                                  | значение по умолчанию
------------------ | ----------------------------------------- | ---------------------
--input_directory  | путь к директории с исходными данными     | ../data_edf
--output_directory | путь к директории для записи новых файлов | ../data_npz

#### ❕❗❕ Некоторые файлы могут быть некорректны и невозможны для обработки ❕❗❕

### Пример: 

python edf_to_npz_parsing/main.py --input_directory=./edf_dir --output_directory=./npz_dir


***

## Классификация
Чтобы классифицировать данные ЭЭГ по стадиям сна, необходимо запустить **classifier/main.py**

### Параметры:

параметр           | описание                                                                            | значение по умолчанию
------------------ | ----------------------------------------------------------------------------------- | ---------------------
--input_directory  | путь к директории с исходными данными                                               | ../data_npz
--model_file_path  | путь к файлу модели сверточной нейронной сети                                       | ../models/(0_8__0_87).h5
--report_dir_path  | путь к директории отчетов по классификации                                          | ../reports
--plot_dir_path    | путь к директории изображений графиков                                              | ../plots
--do_fit           | параметр, определяющий, требуется ли обучение, или только загрузка весов из файла   | *False*

### Пример: 

python classifier/main.py --input_directory=./npz_dir --model_file_path=./model.h5 --report_dir_path=./report

#### ❕❗❕ если результаты классификации после обучения низкие (точность <= 0.4) ❕❗❕
#### ❕❗❕ попробуйте заменить цикл for в classifier/model:36 повторениями тела цикла ❕❗❕
